'''
Github: https://github.com/MohamedEmbaby00/Pentesting-Tools
Usage:
	Example: python3 dir-searcher.py -H http://127.0.0.1/ -w wordlist.txt		--> (Default: 404 status code is hidden)
	Example: python3 dir-searcher.py -H https://target.com -w wordlist.txt -hc 303,403,500
'''

import requests, concurrent.futures, argparse, colorama
from socket import gethostbyname
from termcolor import colored
from time import time


parser = argparse.ArgumentParser(description='========== Simple Directory Searcher ==========', usage='python3 dir-searcher.py -H <host> -w <wordlist>')
parser.add_argument('-H', '--host', metavar='', required=True, help='Specify a host')
parser.add_argument('-w', '--wordlist', metavar='', required=True, help='Specify a wordlist')
parser.add_argument('-hc', '--hide', metavar='', help='Specify status code to hide')
args = parser.parse_args()

colorama.init()
wordlist = open(args.wordlist, encoding='utf8')

if not args.host.startswith(('http://', 'https://')):
	print ('[-] Error, Enter a valid url')
	exit(0)

if not args.host.endswith('/'):
	args.host+= '/'

start_time = time()

try:
	gethostbyname(args.host.split('/')[2])
	print (colored('[*] Starting Dir-searcher...', 'yellow'))
except:
	print (colored('[-] Unable to resolve hostname!', 'red'))
	exit(0)


def fuzzer(word):
	req = requests.get(args.host + word.strip(), timeout=3)
	if req.status_code != 404:
		if args.hide:
			if ',' in args.hide:
				codes_to_hide = list(map(int,args.hide.split(',')))
				if req.status_code not in codes_to_hide:
					print (colored(f'[*] /{req.url} (Status: {req.status_code})', 'green'))
				else:
					pass
			elif ((',' not in args.hide) and (req.status_code != int(args.hide))):
				print (colored(f'[*] /{req.url} (Status: {req.status_code})', 'green'))
			else:
				pass
				exit(0)
		else:
			print (colored(f'[*] /{req.url} (Status: {req.status_code})', 'green'))
	else:
		pass


with concurrent.futures.ThreadPoolExecutor() as executor:
	executor.map(fuzzer, wordlist.readlines())

wordlist.close()
end_time = time()
print (colored(f'\r\n[*] Finished in {end_time-start_time} Second(s)', 'yellow'))